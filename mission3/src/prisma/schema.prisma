generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  id          String           @id @default(uuid())
  name        String
  description String? //컬럼이 null을 허용
  price       Float
  tags        Tag
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt //자동갱신되기 때문에 updatedat사용 default now 사용하면 생성은 되지만 이후 업데이트 시 수동으로 덮어써야 함
  comments    ProductComment[]
}

//updatedAt을 쓰면 디버깅에 대한 이점이 있음, 신경쓰지 않는다면 DateTime?을 써도 됨. 권장되지는 않는 듯.
model Article {
  id        String           @id @default(uuid())
  title     String //글자 제한?
  content   String //글자 제한?
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt
  comments  ArticleComment[]
}

//닉네임이 공백을 허용했기 때문에 struct에서 변수 제한해야 됨
model ProductComment {
  id           String    @id @default(uuid())
  content      String
  nickname     Nickname? @relation(fields: [nicknameId], references: [id], onDelete: SetNull)
  nicknameId   String?
  nicknameText String?
  product      Product   @relation(fields: [productId], references: [id], onDelete: Cascade)
  productId    String
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model ArticleComment {
  id           String    @id @default(uuid())
  content      String
  nickname     Nickname? @relation(fields: [nicknameId], references: [id], onDelete: SetNull)
  nicknameId   String?
  nicknameText String?
  article      Article   @relation(fields: [articleId], references: [id], onDelete: Cascade)
  articleId    String
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

//닉네임을 고유로 가지며 중복 글 작성 가능
model Nickname {
  id              String           @id @default(uuid())
  nickname        String           @unique
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  productComments ProductComment[]
  articleComments ArticleComment[]
}

enum Tag {
  SPORTS
  INSTRUMENTS
  FURNITURE
  FASHION
  ELECTRONICS
}
